{"intl":"var _=function(){var D={\"en\":{}},X=require(\"$\").intl;function _(){return X(D,arguments);}_.all=D;return _}();\r\n","src":"/** @module wdg.layout-stack */require( 'wdg.layout-stack', function(require, module, exports) { var _=function(){var D={\"en\":{}},X=require(\"$\").intl;function _(){return X(D,arguments);}_.all=D;return _}();\r\n    /**\r\n * @module wdg.layout-stack\r\n *\r\n * @description\r\n *\r\n *\r\n * @example\r\n * var Layout = require('wdg.layout-stack');\r\n * var layout = new Layout({\r\n *   value: \"main\",\r\n *   content: {\r\n *     main: ...,\r\n *     page: ...\r\n *   }\r\n * });\r\n */\r\n\r\nvar $ = require(\"dom\");\r\nvar DB = require(\"tfw.data-binding\");\r\nvar Hash = require(\"tfw.hash-watcher\");\r\n\r\n\r\nvar LayoutStack = function(opts) {\r\n    var that = this;\r\n\r\n    var elem = $.elem( this, 'div', 'wdg-layout-stack' );\r\n    var children = {};\r\n\r\n    var onHashChange = function( args, hash ) {\r\n        var rx = that.hash;\r\n        if (!rx) return;\r\n        var m = rx.exec( hash );\r\n        if (!m) return;\r\n        if (m.length < 2) return;\r\n        that.value = m[1];\r\n    };\r\n\r\n    DB.propString(this, 'value')(function(v) {\r\n        var key, val;\r\n        for( key in children ) {\r\n            val = children[key];\r\n            if (typeof val.element === 'function') {\r\n                val = val.element();\r\n            }\r\n            else if (typeof val.element !== 'undefined') {\r\n                val = val.element;\r\n            }\r\n            val = val.parentNode;\r\n            if (val) {\r\n                if (key == v) {\r\n                    $.addClass( val, 'fade-in' );\r\n                    $.removeClass( val, 'fade-out' );\r\n                } else {\r\n                    $.addClass( val, 'fade-out' );\r\n                    $.removeClass( val, 'fade-in' );\r\n                }\r\n            }\r\n        }\r\n    });\r\n    DB.propRegexp(this, 'hash')(function() {\r\n        Hash( onHashChange );\r\n    });\r\n    DB.prop(this, 'content')(function(v) {\r\n        if (Array.isArray( v )) {\r\n            // Convert array into map.\r\n            // Each item should have the `$key` property.\r\n            // If not, an incremental ID will be provided.\r\n            var obj = {};\r\n            var firstKey;\r\n            v.forEach(function (itm, idx) {\r\n                if( typeof itm.$key === 'undefined' ) itm.$key = idx;\r\n                obj[itm.$key] = itm;\r\n                if( typeof firstKey === 'undefined' ) itm.$key = firstKey;\r\n            });\r\n            v = obj;\r\n            DB.fire(that, 'value', firstKey);\r\n        }\r\n\r\n        // Clearing current element to add children.\r\n        $.clear( elem );\r\n\r\n        var key, val, container;\r\n        for( key in v ) {\r\n            val = v[key];\r\n            if (typeof val.element === 'function') {\r\n                val = val.element();\r\n            }\r\n            else if (typeof val.element !== 'undefined') {\r\n                val = val.element;\r\n            }\r\n            container = $.div([val]);\r\n            if (typeof val.$scroll !== 'undefined') {\r\n                $.addClass( container, 'scroll' );\r\n            }\r\n            $.add( elem, container );\r\n        }\r\n\r\n        children = v;\r\n        DB.fire( that, 'value' );\r\n    });\r\n    DB.propAddClass(this, 'wide');\r\n    DB.propRemoveClass(this, 'visible', 'hide');\r\n\r\n    opts = DB.extend({\r\n        value: '',\r\n        content: {},\r\n        hash: null,\r\n        wide: false,\r\n        visible: true\r\n    }, opts, this);\r\n};\r\n\r\n\r\nmodule.exports = LayoutStack;\r\n\r\n\r\n  \r\nmodule.exports._ = _;\n/**\n * @module wdg.layout-stack\n * @see module:$\n * @see module:dom\n * @see module:tfw.data-binding\n * @see module:tfw.hash-watcher\n\n */\n});","zip":"require(\"wdg.layout-stack\",function(e,n,t){var i=function(){function n(){return i(t,arguments)}var t={en:{}},i=e(\"$\").intl;return n.all=t,n}(),a=e(\"dom\"),o=e(\"tfw.data-binding\"),r=e(\"tfw.hash-watcher\"),d=function(e){var n=this,t=a.elem(this,\"div\",\"wdg-layout-stack\"),i={},d=function(e,t){var i=n.hash;if(i){var a=i.exec(t);a&&(a.length<2||(n.value=a[1]))}};o.propString(this,\"value\")(function(e){var n,t;for(n in i)t=i[n],\"function\"==typeof t.element?t=t.element():\"undefined\"!=typeof t.element&&(t=t.element),t=t.parentNode,t&&(n==e?(a.addClass(t,\"fade-in\"),a.removeClass(t,\"fade-out\")):(a.addClass(t,\"fade-out\"),a.removeClass(t,\"fade-in\")))}),o.propRegexp(this,\"hash\")(function(){r(d)}),o.prop(this,\"content\")(function(e){if(Array.isArray(e)){var r,d={};e.forEach(function(e,n){\"undefined\"==typeof e.$key&&(e.$key=n),d[e.$key]=e,\"undefined\"==typeof r&&(e.$key=r)}),e=d,o.fire(n,\"value\",r)}a.clear(t);var f,l,s;for(f in e)l=e[f],\"function\"==typeof l.element?l=l.element():\"undefined\"!=typeof l.element&&(l=l.element),s=a.div([l]),\"undefined\"!=typeof l.$scroll&&a.addClass(s,\"scroll\"),a.add(t,s);i=e,o.fire(n,\"value\")}),o.propAddClass(this,\"wide\"),o.propRemoveClass(this,\"visible\",\"hide\"),e=o.extend({value:\"\",content:{},hash:null,wide:!1,visible:!0},e,this)};n.exports=d,n.exports._=i});\n//# sourceMappingURL=wdg.layout-stack.js.map","map":{"version":3,"file":"wdg.layout-stack.js.map","sources":["wdg.layout-stack.js"],"sourcesContent":["/** @module wdg.layout-stack */require( 'wdg.layout-stack', function(require, module, exports) { var _=function(){var D={\"en\":{}},X=require(\"$\").intl;function _(){return X(D,arguments);}_.all=D;return _}();\r\n    /**\r\n * @module wdg.layout-stack\r\n *\r\n * @description\r\n *\r\n *\r\n * @example\r\n * var Layout = require('wdg.layout-stack');\r\n * var layout = new Layout({\r\n *   value: \"main\",\r\n *   content: {\r\n *     main: ...,\r\n *     page: ...\r\n *   }\r\n * });\r\n */\r\n\r\nvar $ = require(\"dom\");\r\nvar DB = require(\"tfw.data-binding\");\r\nvar Hash = require(\"tfw.hash-watcher\");\r\n\r\n\r\nvar LayoutStack = function(opts) {\r\n    var that = this;\r\n\r\n    var elem = $.elem( this, 'div', 'wdg-layout-stack' );\r\n    var children = {};\r\n\r\n    var onHashChange = function( args, hash ) {\r\n        var rx = that.hash;\r\n        if (!rx) return;\r\n        var m = rx.exec( hash );\r\n        if (!m) return;\r\n        if (m.length < 2) return;\r\n        that.value = m[1];\r\n    };\r\n\r\n    DB.propString(this, 'value')(function(v) {\r\n        var key, val;\r\n        for( key in children ) {\r\n            val = children[key];\r\n            if (typeof val.element === 'function') {\r\n                val = val.element();\r\n            }\r\n            else if (typeof val.element !== 'undefined') {\r\n                val = val.element;\r\n            }\r\n            val = val.parentNode;\r\n            if (val) {\r\n                if (key == v) {\r\n                    $.addClass( val, 'fade-in' );\r\n                    $.removeClass( val, 'fade-out' );\r\n                } else {\r\n                    $.addClass( val, 'fade-out' );\r\n                    $.removeClass( val, 'fade-in' );\r\n                }\r\n            }\r\n        }\r\n    });\r\n    DB.propRegexp(this, 'hash')(function() {\r\n        Hash( onHashChange );\r\n    });\r\n    DB.prop(this, 'content')(function(v) {\r\n        if (Array.isArray( v )) {\r\n            // Convert array into map.\r\n            // Each item should have the `$key` property.\r\n            // If not, an incremental ID will be provided.\r\n            var obj = {};\r\n            var firstKey;\r\n            v.forEach(function (itm, idx) {\r\n                if( typeof itm.$key === 'undefined' ) itm.$key = idx;\r\n                obj[itm.$key] = itm;\r\n                if( typeof firstKey === 'undefined' ) itm.$key = firstKey;\r\n            });\r\n            v = obj;\r\n            DB.fire(that, 'value', firstKey);\r\n        }\r\n\r\n        // Clearing current element to add children.\r\n        $.clear( elem );\r\n\r\n        var key, val, container;\r\n        for( key in v ) {\r\n            val = v[key];\r\n            if (typeof val.element === 'function') {\r\n                val = val.element();\r\n            }\r\n            else if (typeof val.element !== 'undefined') {\r\n                val = val.element;\r\n            }\r\n            container = $.div([val]);\r\n            if (typeof val.$scroll !== 'undefined') {\r\n                $.addClass( container, 'scroll' );\r\n            }\r\n            $.add( elem, container );\r\n        }\r\n\r\n        children = v;\r\n        DB.fire( that, 'value' );\r\n    });\r\n    DB.propAddClass(this, 'wide');\r\n    DB.propRemoveClass(this, 'visible', 'hide');\r\n\r\n    opts = DB.extend({\r\n        value: '',\r\n        content: {},\r\n        hash: null,\r\n        wide: false,\r\n        visible: true\r\n    }, opts, this);\r\n};\r\n\r\n\r\nmodule.exports = LayoutStack;\r\n\r\n\r\n  \r\nmodule.exports._ = _;\n});"],"names":["require","module","exports","_","X","D","arguments","en","intl","all","$","DB","Hash","LayoutStack","opts","that","this","elem","children","onHashChange","args","hash","rx","m","exec","length","value","propString","v","key","val","element","parentNode","addClass","removeClass","propRegexp","prop","Array","isArray","firstKey","obj","forEach","itm","idx","$key","fire","clear","container","div","$scroll","add","propAddClass","propRemoveClass","extend","content","wide","visible"],"mappings":"AAA+BA,QAAS,mBAAoB,SAASA,EAASC,EAAQC,GAAW,GAAIC,GAAE,WAA+C,QAASA,KAAI,MAAOC,GAAEC,EAAEC,WAA5D,GAAID,IAAGE,OAASH,EAAEJ,EAAQ,KAAKQ,IAAiD,OAARL,GAAEM,IAAIJ,EAASF,KAkBrMO,EAAIV,EAAQ,OACZW,EAAKX,EAAQ,oBACbY,EAAOZ,EAAQ,oBAGfa,EAAc,SAASC,GACvB,GAAIC,GAAOC,KAEPC,EAAOP,EAAEO,KAAMD,KAAM,MAAO,oBAC5BE,KAEAC,EAAe,SAAUC,EAAMC,GAC/B,GAAIC,GAAKP,EAAKM,IACd,IAAKC,EAAL,CACA,GAAIC,GAAID,EAAGE,KAAMH,EACZE,KACDA,EAAEE,OAAS,IACfV,EAAKW,MAAQH,EAAE,MAGnBZ,GAAGgB,WAAWX,KAAM,SAAS,SAASY,GAClC,GAAIC,GAAKC,CACT,KAAKD,IAAOX,GACRY,EAAMZ,EAASW,GACY,kBAAhBC,GAAIC,QACXD,EAAMA,EAAIC,UAEkB,mBAAhBD,GAAIC,UAChBD,EAAMA,EAAIC,SAEdD,EAAMA,EAAIE,WACNF,IACID,GAAOD,GACPlB,EAAEuB,SAAUH,EAAK,WACjBpB,EAAEwB,YAAaJ,EAAK,cAEpBpB,EAAEuB,SAAUH,EAAK,YACjBpB,EAAEwB,YAAaJ,EAAK,eAKpCnB,EAAGwB,WAAWnB,KAAM,QAAQ,WACxBJ,EAAMO,KAEVR,EAAGyB,KAAKpB,KAAM,WAAW,SAASY,GAC9B,GAAIS,MAAMC,QAASV,GAAK,CAIpB,GACIW,GADAC,IAEJZ,GAAEa,QAAQ,SAAUC,EAAKC,GACG,mBAAbD,GAAIE,OAAuBF,EAAIE,KAAOD,GACjDH,EAAIE,EAAIE,MAAQF,EACQ,mBAAbH,KAA2BG,EAAIE,KAAOL,KAErDX,EAAIY,EACJ7B,EAAGkC,KAAK9B,EAAM,QAASwB,GAI3B7B,EAAEoC,MAAO7B,EAET,IAAIY,GAAKC,EAAKiB,CACd,KAAKlB,IAAOD,GACRE,EAAMF,EAAEC,GACmB,kBAAhBC,GAAIC,QACXD,EAAMA,EAAIC,UAEkB,mBAAhBD,GAAIC,UAChBD,EAAMA,EAAIC,SAEdgB,EAAYrC,EAAEsC,KAAKlB,IACQ,mBAAhBA,GAAImB,SACXvC,EAAEuB,SAAUc,EAAW,UAE3BrC,EAAEwC,IAAKjC,EAAM8B,EAGjB7B,GAAWU,EACXjB,EAAGkC,KAAM9B,EAAM,WAEnBJ,EAAGwC,aAAanC,KAAM,QACtBL,EAAGyC,gBAAgBpC,KAAM,UAAW,QAEpCF,EAAOH,EAAG0C,QACN3B,MAAO,GACP4B,WACAjC,KAAM,KACNkC,MAAM,EACNC,SAAS,GACV1C,EAAME,MAIbf,GAAOC,QAAUW,EAIjBZ,EAAOC,QAAQC,EAAIA"},"dependencies":["mod/$","mod/dom","mod/tfw.data-binding","mod/tfw.hash-watcher"]}